Autotest.add_hook :initialize do |at|
  unless ARGV.empty?
    at.find_directories = ARGV.length == 1 ? ["spec/#{ARGV.first}","app/#{ARGV.first}"] : ARGV.dup
  end
  %w{log .git .svn .hg test.sqlite3 debug.log }.each do |exception|
    at.add_exception(exception)
  end
end
Autotest.add_hook :reset do |at|
  at.clear_mappings
  at.add_mapping(/^(.*?)(_spec)?\.rb$/) { |filename, m|
    if m[2]
      filename
    else
      "#{m[1]}_spec.rb"
    end
  }
end
